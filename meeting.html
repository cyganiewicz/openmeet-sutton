<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>OpenMeet – Meeting</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="./assets/theme.css">
</head>
<body>
<div class="wrap">
  <a class="btn" href="./">← All meetings</a>
  <div id="meta" class="card"></div>
  <h3>Documents</h3>
  <div id="files"></div>
</div>

<script type="module">
  import { WEBAPP_URL } from './js/auth.js';
  const id=new URLSearchParams(location.search).get('id');
  async function j(u){ const r=await fetch(u); return r.json(); }
  const m = await j(`${WEBAPP_URL}?route=api/public/meeting&id=${encodeURIComponent(id)}`);
  document.getElementById('meta').innerHTML = `
    <div class="muted">${m.board_name||''}</div>
    <div style="font-size:18px;margin:6px 0"><strong>${m.date}</strong> — ${m.title||''}</div>
    <div>${m.location||''}</div>
    <div class="muted" style="margin-top:6px">Status: ${m.status}${m.posted_at?` • Posted ${m.posted_at}`:''}</div>
  `;
  const files = await j(`${WEBAPP_URL}?route=api/public/files&meeting_id=${encodeURIComponent(id)}`);
  const root=document.getElementById('files');
  if(!files.length){ const d=document.createElement('div'); d.className='card muted'; d.textContent='No documents yet.'; root.appendChild(d); }
  files.forEach(x=>{
    const d=document.createElement('div'); d.className='card';
    d.innerHTML = `<a class="btn" target="_blank" href="${x.url}">${x.label||x.type}</a>` + (x.change_log? `<div class="muted" style="margin-top:6px">${x.change_log}</div>`:'');
    root.appendChild(d);
  });
</script>
</body>
</html>
